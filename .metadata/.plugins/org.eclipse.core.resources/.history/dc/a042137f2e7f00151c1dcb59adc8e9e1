package com.jdata.db.jdata.core;

import java.io.IOException;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.SQLException;

import com.jdata.db.jdata.helpers.ConfigHelper;

public class ConnectionFactory {
	static ConnectionFactory instance;
	ConfigHelper config;
	
	private ConnectionFactory() {
		try {
			config = new ConfigHelper();
			//config.LoadConfigValues();
			Class.forName(config.getDBDriverClass());
		} catch (ClassNotFoundException e) {
			e.printStackTrace();
		}
	}
	
	private Connection createConnection() {
		Connection connection = null;
		try {
			connection = DriverManager.getConnection(config.getDBUrl() + config.getDBName(), config.getDBUser(), config.getDBPwd());
		} catch (SQLException exception) {
			exception.printStackTrace();
		}
		
		return connection;
	}
	
	public static Connection getConnection() {
		if (instance != null) {
			instance = new ConnectionFactory();
		}
		return instance.createConnection();
	}
	
	
	@SuppressWarnings("static-access")
	public static void close() {
		if (instance != null) {
			instance.close();
		}
	}
	
}
